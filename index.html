<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>French Flashcards</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Learn French with spaced repetition flashcards">
    <meta name="theme-color" content="#c1272d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="French">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Source+Serif+4:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <header>
            <div class="header-top">
                <div class="logo">
                    <span class="logo-icon">
                        <span class="tricolore-bar tricolore-bleu"></span>
                        <span class="tricolore-bar tricolore-blanc"></span>
                        <span class="tricolore-bar tricolore-rouge"></span>
                    </span>
                    <h1>français</h1>
                </div>
                <div class="header-actions">
                    <div id="auth-area">
                        <button id="login-btn" class="auth-btn">Log In</button>
                        <span id="sync-status" class="sync-status hidden"></span>
                        <button id="logout-btn" class="auth-btn hidden">Log Out</button>
                    </div>
                    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="stats-container">
                <div class="stat-card">
                    <span class="stat-value" id="due-count">0</span>
                    <span class="stat-label">Due Today</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="learned-count">0</span>
                    <span class="stat-label">Learned</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="total-count">0</span>
                    <span class="stat-label">Total</span>
                </div>
            </div>
            <div class="art-deco-divider"></div>
        </header>

        <nav class="tabs">
            <button class="tab active" data-tab="study">
                Étudier
            </button>
            <button class="tab" data-tab="browse">
                Parcourir
            </button>
            <button class="tab" data-tab="settings">
                Réglages
            </button>
        </nav>

        <main>
            <!-- Study View -->
            <section id="study-view" class="view active">
                <div class="study-mode-selector">
                    <label for="study-mode">Mode</label>
                    <select id="study-mode" class="study-mode-select">
                        <option value="all">All Cards</option>
                        <option value="critical">Critical Irregulars (être, avoir, aller)</option>
                        <option value="vocabulary">Vocabulary Only</option>
                        <option value="sentences">Sentences Only</option>
                        <option value="verbs">Verbs Only</option>
                    </select>
                </div>
                <div class="study-mode-selector">
                    <label for="lesson-filter">Lesson</label>
                    <select id="lesson-filter" class="study-mode-select">
                        <option value="all">All Lessons</option>
                    </select>
                </div>
                <div class="card-container">
                    <div class="card" id="flashcard">
                        <div class="card-inner">
                            <div class="card-front">
                                <span class="card-type" id="card-type">Vocabulary</span>
                                <div class="audio-buttons" id="audio-buttons">
                                    <button class="audio-btn" id="audio-male" title="Play (Male voice)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                                        </svg>
                                        <span class="audio-label">M</span>
                                    </button>
                                    <button class="audio-btn" id="audio-female" title="Play (Female voice)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                                        </svg>
                                        <span class="audio-label">F</span>
                                    </button>
                                </div>
                                <p class="card-text" id="front-text"></p>
                                <span class="hint" id="card-hint">Tap to reveal</span>
                            </div>
                            <div class="card-back">
                                <div class="audio-buttons" id="audio-buttons-back">
                                    <button class="audio-btn" id="audio-male-back" title="Play (Male voice)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                                        </svg>
                                        <span class="audio-label">M</span>
                                    </button>
                                    <button class="audio-btn" id="audio-female-back" title="Play (Female voice)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                                        </svg>
                                        <span class="audio-label">F</span>
                                    </button>
                                </div>
                                <p class="card-text" id="back-text"></p>
                                <p class="card-example" id="card-example"></p>
                            </div>
                        </div>
                    </div>
                    <div class="card-glow"></div>
                </div>

                <div class="controls" id="show-controls">
                    <button class="btn btn-primary btn-large" id="show-btn">
                        <span>Show Answer</span>
                        <kbd>Space</kbd>
                    </button>
                </div>

                <div class="controls hidden" id="rate-controls">
                    <button class="btn btn-flip" id="flip-back-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="1 4 1 10 7 10"></polyline>
                            <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                        </svg>
                        <span>Flip</span>
                        <kbd>F</kbd>
                    </button>
                    <button class="btn btn-again" data-rating="1">
                        <span>Again</span>
                        <kbd>1</kbd>
                    </button>
                    <button class="btn btn-hard" data-rating="2">
                        <span>Hard</span>
                        <kbd>2</kbd>
                    </button>
                    <button class="btn btn-good" data-rating="3">
                        <span>Good</span>
                        <kbd>3</kbd>
                    </button>
                    <button class="btn btn-easy" data-rating="4">
                        <span>Easy</span>
                        <kbd>4</kbd>
                    </button>
                </div>

                <div class="empty-state hidden" id="empty-state">
                    <div class="empty-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <h2>All caught up!</h2>
                    <p>No cards due for review right now.<br>Come back later or study all cards.</p>
                    <button class="btn btn-primary" id="study-all-btn">Study All Cards</button>
                </div>
            </section>

            <!-- Browse View -->
            <section id="browse-view" class="view hidden">
                <div class="browse-header">
                    <div class="search-wrapper">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        <input type="text" id="search-input" placeholder="Search cards..." class="search-input">
                    </div>
                    <select id="filter-select" class="filter-select">
                        <option value="all">All Cards</option>
                        <option value="vocabulary">Vocabulary</option>
                        <option value="sentence">Sentences</option>
                        <option value="verb">Verbs</option>
                    </select>
                </div>
                <div class="card-list" id="card-list"></div>
            </section>

            <!-- Settings View -->
            <section id="settings-view" class="view hidden">
                <div class="settings-group">
                    <div class="settings-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="17 1 21 5 17 9"></polyline>
                            <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                            <polyline points="7 23 3 19 7 15"></polyline>
                            <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                        </svg>
                        <h3>Study Direction</h3>
                    </div>
                    <div class="radio-group">
                        <label class="radio-card">
                            <input type="radio" name="direction" value="fr-en" checked>
                            <span class="radio-content">
                                <span class="radio-title">French → English</span>
                                <span class="radio-desc">See French, recall English</span>
                            </span>
                        </label>
                        <label class="radio-card">
                            <input type="radio" name="direction" value="en-fr">
                            <span class="radio-content">
                                <span class="radio-title">English → French</span>
                                <span class="radio-desc">See English, recall French</span>
                            </span>
                        </label>
                        <label class="radio-card">
                            <input type="radio" name="direction" value="mixed">
                            <span class="radio-content">
                                <span class="radio-title">Mixed</span>
                                <span class="radio-desc">Random direction each card</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="settings-divider"></div>

                <div class="settings-group">
                    <div class="settings-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                            <polyline points="2 17 12 22 22 17"></polyline>
                            <polyline points="2 12 12 17 22 12"></polyline>
                        </svg>
                        <h3>Card Types</h3>
                    </div>
                    <div class="toggle-group">
                        <label class="toggle-item">
                            <span class="toggle-label">
                                <span class="toggle-title">Vocabulary</span>
                                <span class="toggle-count" id="vocab-count">0 cards</span>
                            </span>
                            <input type="checkbox" id="include-vocab" class="toggle-input" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <label class="toggle-item">
                            <span class="toggle-label">
                                <span class="toggle-title">Sentences</span>
                                <span class="toggle-count" id="sentence-count">0 cards</span>
                            </span>
                            <input type="checkbox" id="include-sentences" class="toggle-input" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <label class="toggle-item">
                            <span class="toggle-label">
                                <span class="toggle-title">Verbs</span>
                                <span class="toggle-count" id="verb-count">0 cards</span>
                            </span>
                            <input type="checkbox" id="include-verbs" class="toggle-input" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-divider"></div>

                <div class="settings-group settings-danger">
                    <div class="settings-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 6h18"></path>
                            <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                            <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                        </svg>
                        <h3>Reset Data</h3>
                    </div>
                    <p class="settings-desc">Clear all learning progress and start fresh. This cannot be undone.</p>
                    <button class="btn btn-danger" id="reset-btn">Reset All Progress</button>
                </div>
            </section>
        </main>
    </div>

    <div id="auth-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h3 id="auth-modal-title">Log In</h3>
            <div id="magic-link-form" class="magic-link-form">
                <input type="email" id="magic-email" placeholder="Email" autocomplete="email">
                <p id="auth-error" class="auth-error hidden"></p>
                <button type="button" id="magic-send-btn" class="btn btn-primary magic-send-btn">Send login link</button>
            </div>
            <div id="magic-link-sent" class="magic-link-sent hidden">
                <div class="magic-link-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                        <polyline points="22,6 12,13 2,6"></polyline>
                    </svg>
                </div>
                <p class="magic-link-title">Check your email</p>
                <p class="magic-link-desc">We sent a login link to <strong id="magic-email-display"></strong></p>
            </div>
            <button id="auth-close" class="btn btn-secondary auth-close">Cancel</button>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="sync.js"></script>
    <script src="app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
